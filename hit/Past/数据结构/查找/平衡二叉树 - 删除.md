
---
回想一下AVL树的插入操作
- 与删除操作一样的事，他们同样会遇到四种情况。 
![image.png](https://iili.io/JKp4LF9.png)

### 平衡二叉树的删除的具体步骤
![image.png](https://iili.io/JKyzca2.png)
1. 删除节点（方法同二叉排序树）
	- 若删除的结点是叶子，直接删
	- 若删除的节点只有一个子树，用子树顶替删除位置
	- 若删除的节点有两颗子树，用前驱（或后驱）节点顶替，并转换为对前驱（或后驱）节点的删除。
2. 一路向北找到最小不平衡子树，找不到就完结撒花
3. 找到最小不平衡子树下，高度最高的儿子，孙子
4. 根据孙子的位置，调整平衡（LL，LR，RL，RR）
>要我说啊，我觉得这个根插入那里很像，还是排一下ABC三个的大小，把中间大小的变成根就可以了

	- 孙子在LL：儿子右单旋转
	- 孙子在RR：儿子左单旋转
	- 孙子在LR：孙子先左旋转，再右旋转
	- 孙子在RL：孙子先右旋转，再左旋转
6. 如果不平衡向上传导，继续步骤2
![image.png](https://iili.io/JKylTBI.png)
- 我以上图内容作为示例
	1. 如果删除55，从这里向上索引，60仍然平衡，而75这个位置就不平衡了
	![image.png](https://iili.io/JKy0vAG.png)
	2. 然后找个头最高的儿子
		- 70有两个儿子60，80，80这个儿子个头最高
	3. 在个头最高的儿子这里往下找个头最高的孙子
		- 77，90，当然是90这个孙子个头最高
		
	![image.png](https://iili.io/JKy1PXR.png)
	4. 孙子在RR，儿子左单旋
	![image.png](https://iili.io/JKyMk12.png)
	5.不平衡没有向上传导
	![image.png](https://iili.io/JKyVFrN.png)

**另一个示例**
- 如下图，我将要删除节点32
>![image.png](https://iili.io/JKyVuEl.png)
- 进行具体步骤
1. 32是叶节点，直接删除
2. 44是最小的不平衡子树
3. 78 50分别是最高的儿子、孙子
	![image.png](https://iili.io/JKyWccN.png)

4. 这是RL型，也就是父亲<孙子<儿子，那么最后孙子会变成根节点，孙子右旋上，再左旋上。
	![image.png](https://iili.io/JKyWilV.png)

5.没有导致不平衡向上传导，算法结束


**第四个示例（不平衡向上传导）**
![image.png](https://iili.io/JKyOrWF.png)
1. 32是叶子节点，直接删除；
2. 44不平衡，调整，参考上一个例子，这里的不平衡子树就是上一题
3. 3同上
4. 4同上
![image.png](https://iili.io/JKy8Wkx.png)

5. 这里的不平衡性会向上传导，也就是33不平衡了，原来因为右侧伸出来的32节点增加了高度，导致33平衡，现在右侧高度降低，导致整个树不平衡。所以要继续2。这时候从刚刚子树的根50出发，往父节点找，找最小不平衡子树。这里是33，重新进行2

- 循环next
2. 33是最小不平衡子树，
3. 10是最高的儿子，20是最高的孙子
4. LR，于是孙子左上旋，再右上旋
5. 不会了，因为20是整个树的根
![image.png](https://iili.io/JKymeNS.png)

**第五个例子（非叶子节点删除，使用前驱）**
![image.png](https://iili.io/JKyyKkQ.png)
- 如果要删除75，可以选择用直接前驱、后驱来替代，一个子树的根节点的前驱和后驱（中序遍历）
- 前驱是左子树最右节点，后驱是右子树最左节点
- 只需要做数据的复制，比如用60替代，直接把75原封不动修改成60，然后删除60，而60的删除又需要删除55（直接用子树替代，指针指过去也可以），那就把55直接复制给60位置，然后删除55，55可以直接删除。
![image.png](https://iili.io/Jf9dpft.png)
然后继续找最小不平衡子树
![image.png](https://iili.io/Jf92RzQ.png)
然后左旋右旋左旋右旋，然后往上索引继续找，然后成立，然后结束。

**第六个例子（非叶子节点删除，使用后继）**
![image.png](https://iili.io/Jf92s49.png)
右子树的最左孩子，也就是77，77赋值给75，然后转化为删除77，77是叶子，直接删
向上找最小不平衡子树 80
![image.png](https://iili.io/Jf93zGI.png)
此时最高儿子是90，但孙子有两个，其实可以任选，两种都是可以的，但是如果用RR会方便，这比RL的两次旋转要简单很多
- 下图是RR的左单旋
![image.png](https://iili.io/Jf9FViN.png)
- RL右左旋
![image.png](https://iili.io/Jf9f5yg.png)

### 知识回顾
**时间复杂度$O(log_{2}n)$**
![image.png](https://iili.io/Jf9ITkN.png)
